select y.Food_ID , y.num as No_Of_Items, y.Raw_Material_Name, (sum(y.Quantity)*y.num) as Raw_Material_Req from (select raw_materials.RawMaterial_ID, raw_materials.Quantity, customer_record.Food_ID, Raw_Material_Name, sum(customer_record.Quantity) as num from customer_record, raw_materials  where customer_record.Food_ID = raw_materials.Food_ID group by customer_record.Food_ID, raw_materials.RawMaterial_ID)y group by y.RawMaterial_ID, y.Food_ID;